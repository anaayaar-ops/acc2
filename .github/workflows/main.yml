name: Continuous Bot Runner

on:
  workflow_dispatch:
  schedule:
    # '0 22 * * *' ุชุนูู ุงูุณุงุนุฉ 10 ูุณุงุกู ุจุชูููุช ุฌุฑููุชุด = 1 ุตุจุงุญุงู ุจุชูููุช ุงูุณุนูุฏูุฉ
    # ุงูุจูุช ุณูุจุฏุฃ ูู ููู ูู ูุฐุง ุงูููุชุ ูุฅุฐุง ุฃุฑุฏุช ุงุณุชูุฑุงุฑู ูู 4 ุณุงุนุงุช ูู ุฐูู ุงูููุช:
    - cron: '0 22/4 * * *'

concurrency:
  group: bot-runner-group
  cancel-in-progress: true

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '20'

    - name: Install dependencies
      run: npm install

    - name: Execution
      env:
        U_MAIL: ${{ secrets.U_MAIL }}
        U_PASS: ${{ secrets.U_PASS }}
        ENTRY_P: ${{ secrets.ENTRY_P }}
        EXIT_P: ${{ secrets.EXIT_P }}
        MATCH_V: ${{ secrets.MATCH_V }}
        EXEC_V: ${{ secrets.EXEC_V }}
      run: |
        # ุงูุญุตูู ุนูู ุงูุณุงุนุฉ ุงูุญุงููุฉ ุจุชูููุช ููุฉ
        HOUR=$(date +%H -d "+3 hours")
        
        # ุงูุชุญูู ูู ููุช ุงูุฑุงุญุฉ (ุจูู 4 ู 8 ุตุจุงุญุงู)
        if [ "$HOUR" -ge 4 ] && [ "$HOUR" -lt 8 ]; then
          echo "ุชูููุช ุงูุฑุงุญุฉ ุญุงููุงู.. ุงูุณูุฑูุฑ ุณูุจูู ูุชูููุงู ุญุชู ุงูุณุงุนุฉ 8 ุตุจุงุญุงู ๐ค"
          exit 0
        fi
        
        echo "๐ ุจุฏุก ุงูุชุดุบูู ุงููุณุชูุฑ..."
        npm start
